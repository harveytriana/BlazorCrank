@page "/"
@using System.Text

<h1>Native Dependencies - Basic</h1>
<hr />
<pre>@echo</pre>

@code {
    struct Legs
    {
        public float X { get; set; }
        public float Y { get; set; }
    }

    // OPERATIONS
    [DllImport("Operations", CallingConvention = CallingConvention.Cdecl)]
    static extern float hypotenuse(Legs legs);

    string echo = string.Empty;
    
    protected override async Task OnInitializedAsync()
    {
        Echo("Call C++ function...");
        await Task.Delay(2000);
        CallCppFunction();
    }

    void CallCppFunction()
    {
        var legs = new Legs { X = 9, Y = 11 };
        var h = hypotenuse(legs);

        Echo(string.Format("Hypotenuse({0}, {1}) = {2}\n", legs.X, legs.Y, h));
    }

    void Echo(string? message = null)
    {
        if (message is null) {
            echo = string.Empty;
        }
        else {
            var sb = new StringBuilder();
            sb.Append(echo);
            sb.Append(message);
            sb.Append("\n");
            echo = sb.ToString();
            StateHasChanged();
        }
    }
}